
<TestButton@Button>:
    font_size: 20
    background_color: 0, 0, 0, 0
    background_normal: ""
    canvas.before:
        Color:
            rgba: 1, 2, 1, 0.5
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [10]  #---- This rounds the corners --- #


<ButtonTwo@Button>:
    font_size: 20
    background_color: 0, 0, 0, 0
    background_normal: ""
    canvas.before:
        Color:
            rgba: 1, 2, 1, 0.5
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [10]  #---- This rounds the corners --- #



<FirstWindow>:
    name:"first"

    canvas:
        Color:
            rgba: 0,1,0,1
        Line:
            points: self.width*0,self.height*0.3,self.width*1,self.height*0.3

    BoxLayout:
        orientation: 'vertical'
        size: root.width, root.height
        padding: 20
    
        #adaptive_height: False
        #md_bg_color: app.theme_cls.primary_color
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y:0.1
            padding:10

            Label:
                text: "Cashless Vending"
                
                font_size: '20'
                size_hint_x: 1
                size_hint_y:0.9

        BoxLayout:
            orientation: 'horizontal'
            size_hint_y:0.2
            spacing: 20
            padding: 2
                
            TestButton:
                id:Snack1_but
                size_hint_x:0.2
                size_hint_y:1
            
                text: app.Snack1_name + "\nR"+ str(app.Snack1_price)
                disabled: False
                
                on_press: app.Add_cart(app.Snack1_name)
                on_press: app.Update_total(app.Snack1_name)
                on_press: app.Disable_button()
                on_press: app.Rem(app.Snack1_name) 
                on_press: app.TicTok()

            
            TestButton:
                id:Snack2_but
                size_hint_x:0.2
                size_hint_y:1
                
                text:app.Snack2_name + "\nR"+ str(app.Snack2_price)
                disabled: False

                on_press: app.Add_cart(app.Snack2_name)
                on_press: app.Update_total(app.Snack2_name)
                on_press: app.Disable_button()
                on_press: app.Rem(app.Snack2_name)
                on_press: app.TicTok()

            
            TestButton:
                id:Snack3_but
                size_hint_x:0.2
                size_hint_y:1
                
                text:app.Snack3_name + "\nR"+ str(app.Snack3_price)
                disabled: False

                on_press: app.Add_cart(app.Snack3_name)
                on_press: app.Update_total(app.Snack3_name)
                on_press: app.Disable_button()
                on_press: app.Rem(app.Snack3_name)
                on_press: app.TicTok()

        BoxLayout:
            orientation: 'horizontal'
            size_hint_y:0.1

            Label:
                id:Snack1_count
                text:"Available: "+ str(app.Snack1_remain)
                
            Label:
                id:Snack2_count
                text:"Available:"+ str(app.Snack2_remain)
                
            Label:
                id:Snack3_count
                text:"Available:"+ str(app.Snack3_remain)
            
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y:0.25
            spacing: 20
            padding: 2

            TestButton:
                id:Snack4_but
        
                text:app.Snack4_name + "\nR"+ str(app.Snack4_price)
                disabled: False

                on_press: app.Add_cart(app.Snack4_name)
                on_press: app.Update_total(app.Snack4_name)
                on_press: app.Disable_button()
                on_press: app.Rem(app.Snack4_name)
                on_press: app.TicTok()

        
            TestButton:
                id:Snack5_but
                text:app.Snack5_name + "\nR"+ str(app.Snack5_price)
                disabled: False

                on_press: app.Add_cart(app.Snack5_name)
                on_press: app.Update_total(app.Snack5_name)
                on_press: app.Disable_button()
                on_press: app.Rem(app.Snack5_name)
                on_press: app.TicTok()
            

            TestButton:
                id:Snack6_but
            
                text:app.Snack6_name + "\nR"+ str(app.Snack6_price)
                disabled: False

                on_press: app.Add_cart(app.Snack6_name)
                on_press: app.Update_total(app.Snack6_name)
                on_press: app.Disable_button()
                on_press: app.Rem(app.Snack6_name)
                on_press: app.TicTok()
            

        BoxLayout:
            orientation: 'horizontal'
            size_hint_y:0.1
            Label:
                id:Snack4_count
                text:"Available:"+ str(app.Snack4_remain)
                
            Label:
                id:Snack5_count
                text:"Available:"+ str(app.Snack5_remain)
                
            Label:
                id:Snack6_count
                text:"Available:"+ str(app.Snack6_remain)
                
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y:0.1  
            spacing: 40
            padding: 2 
        
            Label:
                text: "Cart:"
                halign: "center"
                
            Label:
                text: "Total:"
                halign: "center"    

        BoxLayout:
            orientation: 'horizontal'
            size_hint_y:0.1
            spacing: 80
            padding: 2 

            Label:
                id:CartID
                text:
        
            Label:
                id:TotalID
                text: 
                
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y:0.1
            spacing: 40
            padding: 2 
    
            ButtonTwo:
                text:"Clear"
                on_press: app.Clear_all(0)
            
            ButtonTwo:
                id:NextBut
                text:"Next"
                disabled: True
                on_press:app.QRcode()
                
                on_press:
                    app.root.current="second"
                    root.manager.transition.direction="left"
                on_press: app.TicTok()
        
                    

<SecondWindow>:
    name:"second"
    title: "SnapScan"

    canvas:
        Color:
            rgba: 1, 1, 1, 1    # White
        # size and position of Canvas
        Rectangle:
            pos: self.center_x - 125, self.center_y + 70
            size: 250, 250
            
    BoxLayout:
        orientation:"vertical"
        size:root.width, root.height
        padding: 20
        spacing: 20

        AsyncImage:
            id: QR
            source:'Loading.png'
            nocache: True
            
        Label:
            id:CheckoutTotal
            text: "Total:"+str(app.Total)
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y:0.3
            spacing: 80
            padding: 2 

            ButtonTwo:
                text:"close" 
                font_size: 20
                on_release:app.root.current="first"
                on_release:app.RemoveImage()
                on_release:app.Clear_all()

            ButtonTwo:
                text:"check payment" 
                font_size: 20
                on_release:app.root.current="thirdwind"
                on_press:app.CallThreadOne()
                on_release: app.TicTok()

            
<ThirdWindow>:
    name:"thirdwind"

    BoxLayout:
        orientation:"vertical"
        size:root.width, root.height
        padding: 20
        spacing: 20

        MDSpinner:
            id: Spinner
            size_hint: None, None
            size: dp(46), dp(46)
            pos_hint: {'center_x': .5, 'center_y': .2}
            active: True
        
        AsyncImage:
            id: Pay_status
            source:'Checking_Payment.png'

        BoxLayout:
            orientation: 'horizontal'
            size_hint_y:0.3
            spacing: 80
            padding: 2 

            ButtonTwo:
                text:"Retry Check Payment" 
                font_size: 20
                on_press:app.CallThreadTwo()
                on_release: app.TicTok() 

            ButtonTwo:
                text:"close" 
                font_size: 20
                on_release:app.root.current="first"
                on_release:app.RemoveImage()
                on_release:app.Clear_all(0)
 

<RootWidget>:

    FirstWindow:
        name: "first"
        id: first
    SecondWindow:
        name: "second"
    ThirdWindow:
        name: "thirdwind"
