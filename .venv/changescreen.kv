
<FirstWindow>:
    name:"first"

    MDGridLayout:
        cols:1
        padding: "15dp"
        
        #adaptive_height: False
        #md_bg_color: app.theme_cls.primary_color
        
        MDLabel:
            text: "Welcome to my app"
            halign: "center"
            font_style: 'H6'
            size_hint_x: 1
            size_hint_y:0.2

        MDGridLayout:
            cols:3

            MDRaisedButton:
                id:Snack1_but
                md_bg_color: "red"
                padding: "12dp"
                font_size: '16dp'
                size_hint_x: 0.33
                text: app.Snack1_name + "\nR"+ str(app.Snack1_price)
                disabled: False
                
                on_press: app.Add_cart(app.Snack1_name)
                on_press: app.Update_total(app.Snack1_name)
                on_press: app.Disable_button()
                on_press: app.Rem(app.Snack1_name)
               
            MDRaisedButton:
                id:Snack2_but
                text:app.Snack2_name + "\nR"+ str(app.Snack2_price)
                disabled: False

                on_press: app.Add_cart(app.Snack2_name)
                on_press: app.Update_total(app.Snack2_name)
                on_press: app.Disable_button()
                on_press: app.Rem(app.Snack2_name)

            MDRaisedButton:
                id:Snack3_but
                text:app.Snack3_name + "\nR"+ str(app.Snack3_price)
                disabled: False

                on_press: app.Add_cart(app.Snack3_name)
                on_press: app.Update_total(app.Snack3_name)
                on_press: app.Disable_button()
                on_press: app.Rem(app.Snack3_name)

            MDLabel:
                id:Snack1_count
                text:"Available: "+ str(app.Snack1_remain)
                halign: "center"
            MDLabel:
                id:Snack2_count
                text:"Available:"+ str(app.Snack2_remain)
            MDLabel:
                id:Snack3_count
                text:"Available:"+ str(app.Snack3_remain)

            MDRaisedButton:
                id:Snack4_but
                text:app.Snack4_name + "\nR"+ str(app.Snack4_price)
                disabled: False

                on_press: app.Add_cart(app.Snack4_name)
                on_press: app.Update_total(app.Snack4_name)
                on_press: app.Disable_button()
                on_press: app.Rem(app.Snack4_name)

            MDRaisedButton:
                id:Snack5_but
                text:app.Snack5_name + "\nR"+ str(app.Snack5_price)
                disabled: False

                on_press: app.Add_cart(app.Snack5_name)
                on_press: app.Update_total(app.Snack5_name)
                on_press: app.Disable_button()
                on_press: app.Rem(app.Snack5_name)
                

            MDRaisedButton:
                id:Snack6_but
                text:app.Snack6_name + "\nR"+ str(app.Snack6_price)
                disabled: False

                on_press: app.Add_cart(app.Snack6_name)
                on_press: app.Update_total(app.Snack6_name)
                on_press: app.Disable_button()
                on_press: app.Rem(app.Snack6_name)
            
            MDLabel:
                id:Snack4_count
                text:"Available:"+ str(app.Snack4_remain)
            MDLabel:
                id:Snack5_count
                text:"Available:"+ str(app.Snack5_remain)
            MDLabel:
                id:Snack6_count
                text:"Available:"+ str(app.Snack6_remain)
                

        MDGridLayout:
            cols:2
            
            MDLabel:
                text: "Cart:"
                
            MDLabel:
                text: "Total:"

            MDLabel:
                id:CartID
                text:
                #height: (len(CartID._lines)+1) * CartID.line_height
            MDLabel:
                id:TotalID
                text: 


        MDGridLayout:
            cols:2
           
            MDRaisedButton:
                text:"Clear"
                on_press: app.Clear_all()
                

            MDRaisedButton:
                id:NextBut
                text:"Next"
                disabled: True
               
                on_press:app.QRcode()
                on_press:
                    app.root.current="second"
                    root.manager.transition.direction="left"
                

<SecondWindow>:
    name:"second"
    title: "SnapScan"

    canvas:
        Color:
            rgba: 1, 1, 1, 1    # White
        # size and position of Canvas
        Rectangle:
            pos: self.pos
            size: self.size
    MDBoxLayout:
        orientation:"vertical"
        size:root.width, root.height

        AsyncImage:
            id: QR
            source:'Loading.png'
            nocache: True
            
        MDLabel:
            id:CheckoutTotal
            text: "Total:"+str(app.Total)

        MDRaisedButton:
            text:"close" 
            font_size: 20
            on_release:app.root.current="first"
            on_release:app.RemoveImage()
            on_release:app.Clear_all()

        MDRaisedButton:
            text:"check payment" 
            font_size: 20
            
            on_press:app.root.current="thirdwind"
            on_release:app.CallThreadOne()

            
<ThirdWindow>:
    name:"thirdwind"

    BoxLayout:
        orientation:"vertical"
        size:root.width, root.height

        MDSpinner:
            id: Spinner
            size_hint: None, None
            size: dp(46), dp(46)
            pos_hint: {'center_x': .5, 'center_y': .5}
            active: True
        
        AsyncImage:
            id: Pay_status
            source:'Checking_Payment.png'

        MDRaisedButton:
            text:"Retry Check Payment" 
            font_size: 20
            on_release:app.CallThreadTwo() 

        MDRaisedButton:
            text:"close" 
            font_size: 20
            on_release:app.root.current="first"
            on_release:app.RemoveImage()
            on_release:app.Clear_all()
 

<RootWidget>:

    FirstWindow:
        name: "first"
    SecondWindow:
        name: "second"
    ThirdWindow:
        name: "thirdwind"
